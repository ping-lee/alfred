{"componentChunkName":"component---src-templates-blog-post-js","path":"/install-postgre-on-centos/","result":{"data":{"site":{"siteMetadata":{"title":"知机县急流津","author":"lee-ping"}},"markdownRemark":{"id":"7417b640-dc63-58a5-994b-bfc39f508a52","html":"<p>在关系型RDBMS的世界里，postgres是备受青睐的，原因得益于两点，像业界oracle数据库一样具有<code class=\"language-text\">可编程性</code>,同时它是免费开源的。拥有复杂查询、外键、触发器、视图、事物完整性、多版本并发控制、数据类型、函数、操作符、聚集函数、索引方法、过程语言如<code class=\"language-text\">PL/PgSQL、Perl、Python、Tcl、Ruby、C或者C++、R</code>。</p>\n<h3 id=\"安装\"><a href=\"#%E5%AE%89%E8%A3%85\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安装</h3>\n<p>操作系统: cenos7 / 安装类型：RPM</p>\n<ol>\n<li>要添加和更新pgdg存储库以获取PostgreSQL 11，在执行下面命令之前我认为你以及安装好rmp软件包管理工具<code class=\"language-text\">dnf</code>，请运行以下命令:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf <span class=\"token function\">install</span> https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm</code></pre></div>\n<ol start=\"2\">\n<li>把postgres添加到repo后，安装服务器软件包（postgres服务程序），安装服务程序的同时客户端程序作为依赖会一起安装，请执行以下操作：</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf <span class=\"token function\">install</span> postgresql11-server</code></pre></div>\n<ol start=\"3\">\n<li>初始化数据库并启用自动启动：</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/usr/pgsql-11/bin/postgresql-11-setup initdb\nsystemctl <span class=\"token builtin class-name\">enable</span> postgresql-11\nsystemctl start postgresql-11</code></pre></div>\n<ol start=\"4\">\n<li>由于某些策略，没有为Red Hat系列发行版启用数据目录的自动启动或自动初始化。因此，您需要手动执行以下步骤来完成数据库安装。</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">service</span> postgresql initdb\n<span class=\"token function\">chkconfig</span> postgresql on</code></pre></div>\n<h3 id=\"创建和访问数据库\"><a href=\"#%E5%88%9B%E5%BB%BA%E5%92%8C%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>创建和访问数据库</h3>\n<p>要创建/删除一个新数据库，在这个名为mydb的示例中，可以使用以下命令：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">su</span> postgres\ncreatedb mydb  <span class=\"token comment\">#create database</span>\ndropdb mydb  <span class=\"token comment\"># drop database</span></code></pre></div>\n<p>psql程序有许多不是SQL命令的内部命令。它们以反斜杠字符“\\”开头。例如，您可以通过键入：<code class=\"language-text\">\\h</code>获得各种PostgreSQL SQL命令语法的帮助，若要退出psql，请键入：<code class=\"language-text\">\\q</code>。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">psql mydb  <span class=\"token comment\">#active mydb database</span>\n<span class=\"token punctuation\">\\</span>h  <span class=\"token comment\"># get help</span>\n<span class=\"token punctuation\">\\</span>q  <span class=\"token comment\"># get out</span></code></pre></div>\n<p>psql输出的最后一行是提示，它表示psql正在监听您，您可以在psql维护的工作空间中键入SQL查询。尝试以下命令：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">mydb</span><span class=\"token operator\">=</span><span class=\"token operator\">></span> SELECT version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                         version\n------------------------------------------------------------------------------------------\n PostgreSQL <span class=\"token number\">11.7</span> on x86_64-pc-linux-gnu, compiled by gcc <span class=\"token punctuation\">(</span>Debian <span class=\"token number\">4.9</span>.2-10<span class=\"token punctuation\">)</span> <span class=\"token number\">4.9</span>.2, <span class=\"token number\">64</span>-bit\n<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> row<span class=\"token punctuation\">)</span>\n\n<span class=\"token assign-left variable\">mydb</span><span class=\"token operator\">=</span><span class=\"token operator\">></span> SELECT current_date<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">date</span>\n------------\n <span class=\"token number\">2016</span>-01-07\n<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> row<span class=\"token punctuation\">)</span>\n\n<span class=\"token assign-left variable\">mydb</span><span class=\"token operator\">=</span><span class=\"token operator\">></span> SELECT <span class=\"token number\">2</span> + <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n ?column?\n----------\n        <span class=\"token number\">4</span>\n<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> row<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"管理配置数据库\"><a href=\"#%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>管理配置数据库</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pg_ctl status -D /var/lib/pgsql/data <span class=\"token comment\"># 查看状态</span>\npg_ctl stop -D /var/lib/pgsql/data <span class=\"token comment\"># 关闭</span>\npg_ctl start -D /var/lib/pgsql/data <span class=\"token comment\"># 启动</span>\npg_ctl restart -D /var/lib/pgsql/data <span class=\"token comment\"># 重启</span>\npg_ctl initdb -D /var/lib/pgsql/data <span class=\"token comment\"># 初始化</span></code></pre></div>\n<p>客户端连接不上数据库时要修改两个文件内容：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#  /var/lib/pgsql/data/postgresql.conf</span>\nlisten_addresses <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n<span class=\"token comment\">#  /var/lib/pgsql/data/pg_hba.conf</span>\n<span class=\"token function\">host</span>    all             all             your_ip/32         trust\n<span class=\"token comment\">#  FATAL: role \"mydb\" is not permitted to log in</span>\nalter user mydb login<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># permission denied for relation test</span>\npsql postgres\n<span class=\"token punctuation\">\\</span>c mydb <span class=\"token comment\"># 切换到mydb数据库</span>\nGRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO mydb<span class=\"token punctuation\">;</span> <span class=\"token comment\"># 赋予所有表的所有权限给mydb</span></code></pre></div>","timeToRead":3,"frontmatter":{"title":"Ⅰ起步：PostgreSQL","date":"April 01, 2020","spoiler":"open source database","cta":"postgres"},"fields":{"slug":"/install-postgre-on-centos/","langKey":"zh-hans"}}},"pageContext":{"slug":"/install-postgre-on-centos/","previous":{"fields":{"slug":"/question-about-back-to-school/","langKey":"zh-hans","directoryName":"question-about-back-to-school","maybeAbsoluteLinks":[]},"frontmatter":{"title":"回到升学的问题上"}},"next":{"fields":{"slug":"/feature-of-postgres/","langKey":"zh-hans","directoryName":"feature-of-postgres","maybeAbsoluteLinks":[]},"frontmatter":{"title":"Ⅱ特性：PostgreSQL"}},"translations":["en"],"translatedLinks":[]}}}